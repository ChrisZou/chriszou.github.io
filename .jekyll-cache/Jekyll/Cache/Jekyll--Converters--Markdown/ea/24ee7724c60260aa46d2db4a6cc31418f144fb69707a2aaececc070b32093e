I"¹<p>å¦‚æœä½ ä½¿ç”¨AndroidStudioç»å¸¸è§‰å¾—å¾ˆå¡ï¼Œé‚£æœ‰å¯èƒ½æ˜¯å› ä¸ºç³»ç»Ÿç»™ASåˆ†é…çš„å†…å­˜ä¸å¤Ÿçš„åŸå› ã€‚æ‰“å¼€/Applications/Android Studio.app/Contents/bin/studio.vmoptions (Mac)ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä»¥ä¸‹é…ç½®ï¼š</p>

<pre><code>-Xms128m  
-Xmx750m  
-XX:MaxPermSize=350m  
-XX:ReservedCodeCacheSize=96m  
-XX:+UseCompressedOops  
</code></pre>

<p>è¿™äº›å‚æ•°åˆ†åˆ«æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p>

<p>####<strong>-Xms128m</strong></p>

<blockquote>
  <p>The -Xms option sets the initial and minimum Java heap size. The Java heap (the â€œheapâ€) is the part of the memory where blocks of memory are allocated to objects and freed during garbage collection.</p>
</blockquote>

<p>å°±æ˜¯JVMå¯åŠ¨çš„èµ·å§‹å †å†…å­˜ï¼Œå †å†…å­˜æ˜¯åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜ã€‚è¿™é‡Œæˆ‘æŠŠå®ƒæ”¹æˆäº†512m</p>

<p>####<strong>-Xmx750m</strong></p>

<blockquote>
  <p>This option sets the maximum Java heap size.</p>
</blockquote>

<p>ä¹Ÿå°±æ˜¯AndroidStudioèƒ½ä½¿ç”¨çš„æœ€å¤§heapå†…å­˜ï¼Œè¿™é‡Œæˆ‘æ”¹æˆäº†2048m</p>

<p>è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯-Xå¼€å¤´çš„ï¼Œè¡¨ç¤ºéæ ‡å‡†çš„å‚æ•°ã€‚ä»€ä¹ˆå«éæ ‡å‡†çš„å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“JVMæœ‰å¾ˆå¤šä¸ªå®ç°ï¼ŒOracleçš„ï¼ŒOpenJDKç­‰ç­‰ï¼Œè¿™é‡Œçš„-Xå‚æ•°ï¼Œæ˜¯Oracleçš„JVMå®ç°ä½¿ç”¨çš„ï¼ŒOpenJDKä¸ä¸€å®šèƒ½ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å°†è¿™äº›å‚æ•°æ ‡å‡†åŒ–ï¼Œè®©æ‰€æœ‰çš„JVMå®ç°éƒ½èƒ½ä½¿ç”¨ã€‚</p>

<p>####<strong>-XX:MaxPermSize=350m</strong></p>

<p>è¿™ä¸ªå‚æ•°æŒ‡å®šæœ€å¤§çš„Permanent generationå¤§å°ã€‚<br />
æ ¹æ®<a href="http://docs.oracle.com/javase/7/docs/technotes/guides/management/jconsole.html">oracleçš„æ–‡æ¡£</a>ï¼š</p>

<blockquote>
  <p>Permanent Generation (non-heap): The pool containing all the reflective data of the virtual machine itself, such as class and method objects. With Java VMs that use class data sharing, this generation is divided into read-only and read-write areas.</p>
</blockquote>

<p>å¯çŸ¥ï¼ŒPermanent Generationä¹Ÿæ˜¯ä¸€å—å†…å­˜åŒºåŸŸï¼Œè·Ÿheapä¸åŒï¼Œå®ƒé‡Œé¢å­˜æ”¾çš„äº‹ç±»æœ¬èº«ï¼ˆä¸æ˜¯å¯¹è±¡ï¼‰ï¼Œä»¥åŠæ–¹æ³•ï¼Œä¸€äº›å›ºå®šçš„å­—ç¬¦ä¸²ç­‰ç­‰ã€‚æ›´å¤šå…³äº<a href="https://blogs.oracle.com/jonthecollector/entry/presenting_the_permanent_generation">Permanent Generation</a></p>

<p>####<strong>-XX:ReservedCodeCacheSize=90m</strong></p>

<blockquote>
  <p>ReservedCodeCacheSize (and InitialCodeCacheSize) is an option for the (just-in-time) compiler of the Java Hotspot VM. Basically it sets the maximum size for the compilerâ€™s code cache.</p>
</blockquote>

<p>è®¾ç½®JIT java compileråœ¨compileçš„æ—¶å€™çš„æœ€å¤§ä»£ç ç¼“å­˜ã€‚ç®€å•åœ°è¯´å°±æ˜¯JITï¼ˆJust In Timeï¼‰ç¼–è¯‘å™¨åœ¨ç¼–è¯‘ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦ç¼“å­˜ä¸€äº›ä¸œè¥¿ï¼Œè¿™ä¸ªå‚æ•°æŒ‡å®šæœ€å¤šèƒ½ä½¿ç”¨å¤šå¤§å†…å­˜æ¥ç¼“å­˜è¿™äº›ä¸œè¥¿ã€‚<br />
ä»€ä¹ˆå«JITå‘¢ï¼Ÿçœ‹<a href="http://en.wikipedia.org/wiki/Just-in-time_compilation">wikipediaçš„è§£é‡Š</a>ï¼š</p>

<blockquote>
  <p>In computing, just-in-time compilation (JIT), also known as dynamic translation, is compilation done during execution of a program â€“ at run time â€“ rather than prior to execution.Most often this consists of translation to machine code, which is then executed directly, but can also refer to translation to another format.
JIT compilation is a combination of the two traditional approaches to translation to machine code â€“ ahead-of-time compilation (AOT), and interpretation â€“ and combines some advantages and drawbacks of both.[1] Roughly, JIT compilation combines the speed of compiled code with the flexibility of interpretation, with the overhead of an interpreter and the additional overhead of compiling (not just interpreting). JIT compilation is a form of dynamic compilation, and allows adaptive optimization such as dynamic recompilation â€“ thus in principle JIT compilation can yield faster execution than static compilation. Interpretation and JIT compilation are particularly suited for dynamic programming languages, as the runtime system can handle late-bound data types and enforce security guarantees.</p>
</blockquote>

<p>æˆ‘ä»¬çŸ¥é“ç¼–ç¨‹è¯­è¨€åˆ†ä¸¤ç§ï¼š</p>
<ul>
  <li>ç¼–è¯‘å‹ï¼Œå…ˆå°†äººå†™çš„ä»£ç æ•´ä¸ªç¼–è¯‘æˆæ±‡ç¼–è¯­è¨€æˆ–æœºå™¨è¯­è¨€ï¼Œä¸€æ¡ä¸€æ¡ä»£ç ç„¶åæ‰§è¡Œã€‚</li>
  <li>è§£é‡Šå‹ï¼Œä¸éœ€è¦ç¼–è¯‘ï¼Œå°†äººå†™çš„ä»£ç ä¸€æ¡ä¸€æ¡æ‹¿è¿‡æ¥ä¸€æ¬¡æ‰§è¡Œï¼Œå…ˆå–ä¸€æ¡ï¼Œæ‰§è¡Œï¼Œå®Œäº†å†å–ä¸‹ä¸€æ¡ï¼Œç„¶ååœ¨æ‰§è¡Œã€‚</li>
</ul>

<p>è€Œå¯¹äºJavaæ¥è¯´ï¼Œè¿™ä¸ªæƒ…å†µå°±æ¯”è¾ƒç‰¹æ®Šäº†ï¼Œå› ä¸ºåœ¨Javaè¿™é‡Œï¼ŒJVMå…ˆæ˜¯å°†Javaä»£ç æ•´ä¸ªç¼–è¯‘æˆbytecodeï¼Œç„¶ååœ¨JVMå†…éƒ¨å†ä¸€æ¡ä¸€æ¡æ‰§è¡Œbytecodeä»£ç ã€‚ä½ è¯´å®ƒæ˜¯ç¼–è¯‘å‹çš„å§ï¼Œbytecodeåˆä¸ç”¨ç¼–è¯‘æˆæœºå™¨ä»£ç ï¼ŒäºŒæ˜¯ä¸€æ¡æ¡bytecodeä¸€æ¬¡æ‰§è¡Œã€‚ä½ è¯´å®ƒæ˜¯è§£é‡Šå‹çš„å§ï¼Œå®ƒåˆæœ‰ä¸€ä¸ªç¼–è¯‘çš„è¿‡ç¨‹ã€‚å¯¹äºJavaåˆ°åº•æ˜¯ç¼–è¯‘å‹è¿˜æ˜¯è§£é‡Šå‹åˆ°ç°åœ¨ä¹Ÿæ²¡æœ‰ä¸€ä¸ªå®šè®ºã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥æ¢è®¨ä¸€ä¸‹Javaçš„JITç¼–è¯‘æŠ€æœ¯ã€‚<br />
åˆšåˆšè¯´äº†ï¼Œåœ¨bytecodeå±‚é¢ï¼Œä»£ç æ˜¯è§£é‡Šæ‰§è¡Œçš„ã€‚è§£é‡Šå‹çš„è¯­è¨€ä¼šæ¯”è¾ƒæ…¢ï¼Œå› ä¸ºå®ƒæ²¡æœ‰åŠæ³•æ ¹æ®ä¸Šä¸‹æ–‡å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ã€‚è€Œç¼–è¯‘å‹çš„è¯­è¨€åˆ™å¯ä»¥è¿›è¡Œä¼˜åŒ–ã€‚Javaçš„JITæŠ€æœ¯ï¼Œå°±æ˜¯åœ¨bytecodeè§£é‡Šæ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒä¸ä¸€å®šæ˜¯ä¸€æ¡æ¡è§£é‡Šæ‰§è¡Œçš„ï¼ŒäºŒæ˜¯å–ä¸€æ®µä»£ç ï¼Œç¼–è¯‘æˆæœºå™¨ä»£ç ï¼Œç„¶åæ‰§è¡Œï¼Œè¿™æ ·çš„è¯å°±æœ‰äº†ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥å¯¹ä»£ç è¿›è¡Œä¼˜åŒ–äº†ï¼Œæ‰€ä»¥æ‰§è¡Œé€Ÿåº¦ä¹Ÿä¼šæ›´å¿«ã€‚<br />
å¯è§ï¼ŒJITæŠ€æœ¯ç»“åˆäº†ç¼–è¯‘å‹ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰å’Œè§£é‡Šå‹è¯­è¨€ï¼ˆä»£ç æ›´çµæ´»ï¼‰äºŒè€…çš„ä¼˜åŠ¿ã€‚å¯¹äºåŠ¨æ€è¯­è¨€çš„æ‰§è¡Œæ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¤§çš„ä¼˜åŠ¿ã€‚</p>

<p>####<strong>-XX:+UseCompressedOops</strong></p>

<p>è¿™ä¸ªå‚æ•°å…è®¸ç³»ç»Ÿå°†ä»£ç é‡Œé¢çš„å¼•ç”¨(reference)ç±»å‹ç”¨32ä½å­˜å‚¨ï¼ŒåŒæ—¶å´èƒ½å¤Ÿè®©å¼•ç”¨èƒ½å¤Ÿä½¿ç”¨64ä½çš„å†…å­˜å¤§å°ã€‚<br />
æˆ‘ä»¬çŸ¥é“ç°ä»£çš„æœºå™¨åŸºæœ¬éƒ½æ˜¯64ä½çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJavaä»£ç é‡Œé¢çš„referenceç±»å‹ä¹Ÿå˜æˆäº†ç”¨64ä½æ¥å­˜å‚¨ï¼Œè¿™å°±å¯¼è‡´äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
  <li>64ä½æ¯”32ä¸ºæ›´å¤§ï¼Œå çš„å†…å­˜æ›´å¤šï¼Œè¿™æ˜¯æ˜¾ç„¶çš„ï¼Œå½“ç„¶è¿™ä¸ªé—®é¢˜åœ¨æ•´ä¸ªç¨‹åºçœ‹æ¥æ ¹æœ¬ä¸æ˜¾ç„¶ï¼Œå› ä¸ºå“ªæ€•ç³»ç»ŸåŒæ—¶æœ‰1000ä¸ªå¼•ç”¨å­˜åœ¨ï¼Œé‚£å¤šå‡ºæ¥çš„å†…å­˜ä¹Ÿå°±4Mï¼Œè¿™ä¸ªä¸é‡è¦ï¼Œå› ä¸ºç°åœ¨æ‰‹æœºéƒ½åŠ¨ä¸åŠ¨å¥½å‡ ä¸ªGï¼Œå¤§å‹æœåŠ¡å™¨å°±æ›´åŠ ä¸ç”¨è¯´äº†ã€‚æ›´é‡è¦çš„æ˜¯ç¬¬äºŒç‚¹ã€‚</li>
  <li>ç›¸å¯¹äºå†…å­˜ï¼ŒCPUçš„cacheå°±å°çš„å¯æ€œäº†ï¼Œå½“referenceä»32bitå˜æˆ64bitæ—¶ï¼Œcacheé‡Œé¢èƒ½å­˜æ”¾çš„referenceæ•°é‡å°±é¡¿æ—¶å°‘äº†å¾ˆå¤šã€‚æ‰€ä»¥64bitçš„referenceå¯¹cacheæ˜¯ä¸ªå¤§é—®é¢˜ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ä¸ªé€‰é¡¹ï¼Œå¯ä»¥å…è®¸ç³»ç»Ÿç”¨32bitæ¥å­˜å‚¨referenceï¼Œè®©cacheé‡Œé¢èƒ½å­˜æ”¾æ›´å¤šçš„referenceï¼ŒåŒæ—¶åˆä¸å½±å“referenceçš„å–å€èŒƒå›´ã€‚è‡³äºä»–ä»¬æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Œæˆ‘å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚ã€‚ã€‚</li>
</ol>

<p>ä»¥ä¸Šä¸‰ä¸ªå‚æ•°æ˜¯ä»¥-XXå¼€å¤´çš„ï¼Œæ ¹æ®<a href="http://www.oracle.com/technetwork/systems/vmoptions-jsp-140102.html">Oracleçš„è¯´æ˜</a>ï¼Œ</p>

<blockquote>
  <p>Options that are specified with -XX are not stable and are subject to change without notice.</p>
</blockquote>

<p>å†™æ–‡ç« å°±æ˜¯ä¸€ä¸ªæŒ–å‘çš„è¿‡ç¨‹ï¼Œè¿™ç¯‡æ–‡ç« ä¾ç„¶åå¾ˆå¤šå‘æ²¡æœ‰å¡«æ»¡ï¼Œè€Œä¸”å¦‚æœè¦ç»§ç»­æŒ–ï¼Œä¹Ÿå¯ä»¥æŒ–å‡ºå¾ˆå¤šå‘ã€‚ç”±äºèƒ½åŠ›æœ‰é™ï¼Œæˆ‘è¿˜æ˜¯å°±æ­¤æ‰“ä½å§ã€‚</p>

<p>æœ€åè´´ä¸Šæˆ‘è‡ªå·±çš„é…ç½®ï¼Œä»…ä¾›å‚è€ƒï¼Œæˆ‘çš„ç”µè„‘æ˜¯å†…å­˜æ˜¯8Gï¼ˆI know, å¼±çˆ†äº†å¯¹å§ï¼Ÿï¼‰ï¼š</p>

<pre><code>-Xms512m  
-Xmx2048m  
-XX:MaxPermSize=1024m  
-XX:ReservedCodeCacheSize=512m  
-XX:+UseCompressedOops  
</code></pre>
:ET